<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é«˜çŸ¥ã‚¯ã‚¨ã‚¹ãƒˆ - é’ã„ãƒ”ãƒ³ã®è©¦ç·´</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #000; }
        #map { height: 100vh; width: 100%; z-index: 1; }

        /* UIã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
        #ui-layer {
            position: absolute; top: 15px; left: 15px; z-index: 100;
            background: rgba(0, 0, 0, 0.85); color: #ffd700;
            padding: 15px; border: 2px solid #ffd700; border-radius: 8px;
            font-family: 'Hiragino Kaku Gothic ProN', sans-serif;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        /* ã‚¯ã‚¤ã‚ºç”»é¢ */
        #quiz-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 1000;
            display: flex; justify-content: center; align-items: center;
        }

        .quiz-content {
            background: #fffbe6; color: #333; padding: 30px;
            border: 6px double #8b4513; width: 85%; max-width: 400px;
            text-align: center; border-radius: 10px;
        }

        .option-btn {
            display: block; width: 100%; margin: 12px 0; padding: 15px;
            background: #2a5d9a; color: white; border: none; 
            cursor: pointer; border-radius: 8px; font-size: 1rem; font-weight: bold;
        }

        .hidden { display: none !important; }
        
        /* ãƒ”ãƒ³ã‚’è§¦ã‚Šã‚„ã™ãã™ã‚‹ãŸã‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .leaflet-marker-icon { cursor: pointer; }
    </style>
</head>
<body>

    <div id="ui-layer">
        <h2 style="margin:0;">ğŸ—¡ï¸ é«˜çŸ¥ã‚¯ã‚¨ã‚¹ãƒˆ</h2>
        <p id="score" style="margin:5px 0 0 0; font-weight: bold;">ç²å¾—ã—ãŸç§˜å®: 0 / 20</p>
    </div>

    <div id="map"></div>

    <div id="quiz-modal" class="hidden">
        <div class="quiz-content">
            <h2 id="quiz-spot-name" style="color: #2a5d9a; margin-top: 0;"></h2>
            <p id="quiz-question" style="font-weight: bold; margin-bottom: 20px;"></p>
            <div id="quiz-options"></div>
            <button onclick="closeQuiz()" style="margin-top:20px; background:none; border:none; color:gray; text-decoration:underline;">é€ƒã’ã‚‹</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // 1. åœ°å›³è¨­å®šï¼ˆé«˜çŸ¥ä¸­å¿ƒï¼‰
        const map = L.map('map', {
            tap: true, // ãƒ¢ãƒã‚¤ãƒ«ã§ã®ã‚¿ãƒƒãƒ—åå¿œã‚’è‰¯ãã™ã‚‹
            zoomControl: false // UIã¨è¢«ã‚‰ãªã„ã‚ˆã†ã‚ºãƒ¼ãƒ ãƒœã‚¿ãƒ³ã‚’æ¶ˆã™
        }).setView([33.5600, 133.5400], 14);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        let score = 0;

        // 2. ã‚¹ãƒãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆã“ã“ã‚’å¢—ã‚„ã—ã¦20å€‹ã«ï¼ï¼‰
        const questSpots = [
            { name: "é«˜çŸ¥åŸ", pos: [33.5607, 133.5314], q: "é«˜çŸ¥åŸã«ã‚ã‚‹ã€è¿½æ‰‹é–€ã¨å¤©å®ˆã‚’ä¸€æšã®å†™çœŸã«åã‚ã‚‰ã‚Œã‚‹ã‚¹ãƒãƒƒãƒˆã¯æœ‰åï¼Ÿ", ops: ["æœ‰åãœã‚ˆ", "çŸ¥ã‚‰ã‚“ã¡ã‚„"], ans: "æœ‰åãœã‚ˆ" },
            { name: "ã¯ã‚Šã¾ã‚„æ©‹", pos: [33.5594, 133.5428], q: "ã¯ã‚Šã¾ã‚„æ©‹ã®ã™ãå´ã«ã‚ã‚‹ã€ã‹ã‚‰ãã‚Šæ™‚è¨ˆãŒå‹•ãé–“éš”ã¯ï¼Ÿ", ops: ["1æ™‚é–“ã”ã¨", "3æ™‚é–“ã”ã¨", "12æ™‚é–“ã”ã¨"], ans: "1æ™‚é–“ã”ã¨" },
            { name: "é«˜çŸ¥é§…å‰", pos: [33.5672, 133.5435], q: "é§…å‰ã®ä¸‰å¿—å£«åƒã€å°é¢¨ãŒæ¥ã‚‹ã¨ã©ã†ãªã‚‹ï¼Ÿ", ops: ["é¿é›£ï¼ˆæ’¤å»ï¼‰ã™ã‚‹", "å€’ã‚Œã‚‹", "å…‰ã‚‹"], ans: "é¿é›£ï¼ˆæ’¤å»ï¼‰ã™ã‚‹" },
            { name: "ã²ã‚ã‚å¸‚å ´", pos: [33.5606, 133.5361], q: "ã²ã‚ã‚å¸‚å ´ã®ã€Œã²ã‚ã‚ã€ã®ç”±æ¥ã¯ï¼Ÿ", ops: ["äººåï¼ˆå¼˜ç€¬ï¼‰", "åºƒã„ã‹ã‚‰", "æ‹¾ã†ã‹ã‚‰"], ans: "äººåï¼ˆå¼˜ç€¬ï¼‰" }
            // ã“ã“ã«ã‚ã¨16å€‹è¿½åŠ ï¼
        ];

        // 3. ãƒãƒ¼ã‚«ãƒ¼ï¼ˆé’ã„ãƒ”ãƒ³ï¼‰ã®è¨­ç½®
        questSpots.forEach((spot, index) => {
            // æ¨™æº–ã®é’ã„ãƒ”ãƒ³ã‚’ä½œæˆ
            const marker = L.marker(spot.pos).addTo(map);
            
            // ãƒ”ãƒ³ã‚’è§¦ã£ãŸï¼ˆã‚¯ãƒªãƒƒã‚¯ãƒ»ã‚¿ãƒƒãƒ—ã—ãŸï¼‰æ™‚ã®å‹•ä½œ
            marker.on('click', (e) => {
                // åœ°å›³ãŒå‹æ‰‹ã«å‹•ã‹ãªã„ã‚ˆã†ã«ã—ã¤ã¤ã‚¯ã‚¤ã‚ºã‚’é–‹ã
                L.DomEvent.stopPropagation(e);
                openQuiz(index);
            });
        });

        function openQuiz(index) {
            const spot = questSpots[index];
            document.getElementById('quiz-spot-name').innerText = spot.name;
            document.getElementById('quiz-question').innerText = spot.q;
            
            const optionsDiv = document.getElementById('quiz-options');
            optionsDiv.innerHTML = ""; 
            
            spot.ops.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "option-btn";
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(opt, spot.ans, index);
                optionsDiv.appendChild(btn);
            });
            
            document.getElementById('quiz-modal').classList.remove('hidden');
        }

        function checkAnswer(userAns, correctAns, index) {
            if (userAns === correctAns) {
                alert("æ­£è§£ï¼ç§˜å®ã‚²ãƒƒãƒˆãœã‚ˆï¼");
                score++;
                document.getElementById('score').innerText = `ç²å¾—ã—ãŸç§˜å®: ${score} / 20`;
            } else {
                alert("ãƒã‚ºãƒ¬ï¼å‡ºç›´ã—ã¡ã‚„ï¼");
            }
            closeQuiz();
        }

        function closeQuiz() {
            document.getElementById('quiz-modal').classList.add('hidden');
        }
    </script>
</body>
</html>
