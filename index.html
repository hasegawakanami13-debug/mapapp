<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>é«˜çŸ¥ã‚¯ã‚¨ã‚¹ãƒˆ</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
html, body {
  margin: 0; padding: 0;
  height: 100%;
  background: #aad3df;
  font-family: "Hiragino Kaku Gothic ProN", sans-serif;
}

#map { height: 100vh; width: 100%; }

#ui-layer {
  position: absolute;
  top: 15px; left: 15px;
  z-index: 1000;
  background: rgba(0,0,0,0.85);
  color: #ffd700;
  padding: 15px;
  border: 2px solid #ffd700;
  border-radius: 8px;
}

#quiz-modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}

.hidden { display: none; }

.quiz-content {
  background: #fffbe6;
  padding: 25px;
  border: 6px double #8b4513;
  border-radius: 10px;
  width: 85%;
  max-width: 420px;
  text-align: center;
}

.option-btn {
  width: 100%;
  margin: 10px 0;
  padding: 14px;
  font-size: 1rem;
  font-weight: bold;
  background: #2a5d9a;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.leaflet-tooltip {
  background: #2a5d9a;
  color: white;
  border: 2px solid #ffd700;
  font-weight: bold;
  border-radius: 6px;
}
</style>
</head>

<body>

<div id="ui-layer">
  <h2 style="margin:0;">ğŸ—ºï¸ é«˜çŸ¥ã‚¯ã‚¨ã‚¹ãƒˆ</h2>
  <p id="score" style="margin:5px 0 0;">ç§˜å®: 0 / 20</p>
</div>

<div id="map"></div>

<div id="quiz-modal" class="hidden">
  <div class="quiz-content">
    <h2 id="quiz-spot-name"></h2>
    <p id="quiz-question"></p>
    <div id="quiz-options"></div>
    <button onclick="closeQuiz()" style="background:none;border:none;color:gray;text-decoration:underline;">é€ƒã’ã‚‹</button>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const kochiBounds = [[32.3,132.0],[34.2,134.8]];
let score = 0;

function stars(n){ return "â˜…".repeat(n)+"â˜†".repeat(3-n); }

const spots = [
 {name:"é«˜çŸ¥åŸ",pos:[33.5607,133.5314],d:1,q:"é«˜çŸ¥åŸã¯è¿½æ‰‹é–€ã¨å¤©å®ˆã‚’åŒæ™‚ã«æ’®ã‚Œã‚‹ï¼Ÿ",ops:["ã¯ã„","ã„ã„ãˆ"],ans:"ã¯ã„"},
 {name:"æ¡‚æµœ",pos:[33.4971,133.5744],d:1,q:"é¾é¦¬åƒã«è¿‘ã¥ã‘ã‚‹æ™‚æœŸã¯ï¼Ÿ",ops:["æ˜¥ã¨ç§‹","å¤","å†¬"],ans:"æ˜¥ã¨ç§‹"},
 {name:"ç‰§é‡æ¤ç‰©åœ’",pos:[33.5463,133.5775],d:2,q:"å¦»ã®åã‚’å–ã£ãŸæ¤ç‰©ã¯ï¼Ÿ",ops:["ã‚¹ã‚¨ã‚³ã‚¶ã‚µ","ã‚³ã‚¦ãƒãƒ¦ãƒª","ãƒã‚­ãƒã‚½ã‚¦"],ans:"ã‚¹ã‚¨ã‚³ã‚¶ã‚µ"},
 {name:"å®¤æˆ¸å²¬",pos:[33.2472,134.1751],d:2,q:"ç©ºæµ·ãŒä¿®è¡Œã—ãŸæ´çªŸã¯ï¼Ÿ",ops:["å¾¡å¨äººçªŸ","é¾æ²³æ´","é’ã®æ´çªŸ"],ans:"å¾¡å¨äººçªŸ"},
 {name:"è¶³æ‘ºå²¬",pos:[32.7231,133.0185],d:1,q:"å››å›½æœ€å—ç«¯ã¯ï¼Ÿ",ops:["è¶³æ‘ºå²¬","å®¤æˆ¸å²¬","æŸå³¶"],ans:"è¶³æ‘ºå²¬"},
 {name:"æŸå³¶",pos:[32.7681,132.6311],d:3,q:"é€æ˜åº¦ã§æœ‰åãªå³¶ã¯ï¼Ÿ",ops:["æŸå³¶","æ²–ã®å³¶","éµœæ¥å³¶"],ans:"æŸå³¶"},
 // ä»¥ä¸‹çœç•¥ã›ãš20ã¾ã§å…¥ã‚Œã¦OKï¼ˆåŒå½¢å¼ï¼‰
];

const map = L.map("map",{
  maxBounds: kochiBounds,
  maxBoundsViscosity: 1,
  minZoom: 9,
  maxZoom: 15,
  zoomControl: false
}).setView([33.35,133.4],9);

L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{
  attribution:"Â© OpenStreetMap"
}).addTo(map);

spots.forEach((s,i)=>{
  const m = L.marker(s.pos).addTo(map);

  m.bindTooltip(
    `<strong>${s.name}</strong><br>é›£æ˜“åº¦ï¼š${stars(s.d)}`,
    {direction:"top",offset:[0,-10]}
  );

  m.on("click",()=>{
    openQuiz(i);
  });
});

function openQuiz(i){
  const s = spots[i];
  document.getElementById("quiz-spot-name").innerText = s.name;
  document.getElementById("quiz-question").innerText = s.q;
  const box = document.getElementById("quiz-options");
  box.innerHTML = "";
  s.ops.forEach(o=>{
    const b = document.createElement("button");
    b.className="option-btn";
    b.innerText=o;
    b.onclick=()=>check(o,s.ans);
    box.appendChild(b);
  });
  document.getElementById("quiz-modal").classList.remove("hidden");
}

function check(a,c){
  if(a===c){
    alert("æ­£è§£ï¼ç§˜å®ã‚²ãƒƒãƒˆãœã‚ˆï¼");
    score++;
    document.getElementById("score").innerText=`ç§˜å®: ${score} / 20`;
  } else {
    alert("ãƒã‚ºãƒ¬ï¼å‡ºç›´ã—ã¡ã‚„ï¼");
  }
  closeQuiz();
}

function closeQuiz(){
  document.getElementById("quiz-modal").classList.add("hidden");
}
</script>
</body>
</html>
