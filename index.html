<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>é«˜çŸ¥ã‚¯ã‚¨ã‚¹ãƒˆ - å¹•æœ«ãƒ»æ­´å²æ¢ç´¢ç·¨</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body, html { margin: 0; padding: 0; height: 100%; overflow: hidden; background: #aad3df; }
        #map { height: 100vh; width: 100%; z-index: 1; }

        /* UIãƒ¬ã‚¤ãƒ¤ãƒ¼ */
        #ui-layer {
            position: absolute; top: 15px; left: 15px; z-index: 100;
            background: rgba(0, 0, 0, 0.85); color: #ffd700;
            padding: 15px; border: 2px solid #ffd700; border-radius: 8px;
            font-family: 'Hiragino Kaku Gothic ProN', sans-serif;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        /* ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ï¼ˆãƒ›ãƒãƒ¼æ™‚ã®ãƒ‡ã‚¶ã‚¤ãƒ³ï¼‰ */
        .custom-tooltip {
            background: rgba(0, 0, 0, 0.9) !important;
            color: #ffd700 !important;
            border: 1px solid #ffd700 !important;
            font-weight: bold;
            font-size: 13px;
            padding: 5px 10px;
            border-radius: 4px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }

        /* ã‚¯ã‚¤ã‚ºç”»é¢ */
        #quiz-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 1000;
            display: flex; justify-content: center; align-items: center;
        }
        .quiz-content {
            background: #fffbe6; color: #333; padding: 30px;
            border: 6px double #8b4513; width: 85%; max-width: 400px;
            text-align: center; border-radius: 10px;
        }
        .option-btn {
            display: block; width: 100%; margin: 12px 0; padding: 15px;
            background: #2a5d9a; color: white; border: none; 
            cursor: pointer; border-radius: 8px; font-size: 1rem; font-weight: bold;
        }

        .hidden { display: none !important; }
        .leaflet-marker-icon { cursor: pointer; }
    </style>
</head>
<body>

    <div id="ui-layer">
        <h2 style="margin:0;">ğŸ—¡ï¸ é«˜çŸ¥ã‚¯ã‚¨ã‚¹ãƒˆ</h2>
        <p id="score" style="margin:5px 0 0 0; font-weight: bold;">ç²å¾—ã—ãŸç§˜å®: 0 / 35</p>
    </div>

    <div id="map"></div>

    <div id="quiz-modal" class="hidden">
        <div class="quiz-content">
            <h2 id="quiz-spot-name" style="color: #2a5d9a; margin-top: 0;"></h2>
            <p id="quiz-question" style="font-weight: bold; margin-bottom: 20px;"></p>
            <div id="quiz-options"></div>
            <button onclick="closeQuiz()" style="margin-top:20px; background:none; border:none; color:gray; text-decoration:underline;">é€ƒã’ã‚‹</button>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const kochiBounds = [[32.3, 132.0], [34.2, 134.8]];

        const map = L.map('map', {
            tap: true,
            zoomControl: false,
            maxBounds: kochiBounds,
            maxBoundsViscosity: 1.0,
            minZoom: 9,
            maxZoom: 15
        }).setView([33.35, 133.4], 9);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap',
            bounds: kochiBounds
        }).addTo(map);

        let score = 0;

        // ã‚¹ãƒãƒƒãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆæ­´å²ãƒ»è¦³å…‰åˆã‚ã›ã¦35å€‹ã®ä¾‹ï¼‰
        const questSpots = [
            // --- å¹•æœ«ãƒ»æ­´å² ---
            { name: "å‚æœ¬é¾é¦¬èª•ç”Ÿåœ°", level: "â˜…2", pos: [33.5614, 133.5285], q: "é¾é¦¬ãŒç”Ÿã¾ã‚ŒãŸã“ã®ä¸Šç”ºï¼ˆã‹ã¿ã¾ã¡ï¼‰ã€‚å¹¼ã„é ƒã®é¾é¦¬ã®ã‚ã åã¯ï¼Ÿ", ops: ["ã‚ã–ï¼ˆç—£ï¼‰å¤ªéƒ", "æ³£ãè™«", "é¼»ãŸã‚Œä¸¸"], ans: "ã‚ã–ï¼ˆç—£ï¼‰å¤ªéƒ" },
            { name: "ä¸­å²¡æ…å¤ªéƒåƒ", level: "â˜…2", pos: [33.2482, 134.1755], q: "é¾é¦¬ã¨å…±ã«è¿‘æ±Ÿå±‹ã§å€’ã‚ŒãŸä¸­å²¡æ…å¤ªéƒã€‚å½¼ã®å‡ºèº«åœ°ã¯ï¼Ÿ", ops: ["åŒ—å·æ‘", "é¦¬è·¯æ‘", "å¥ˆåŠåˆ©ç”º"], ans: "åŒ—å·æ‘" },
            { name: "æ­¦å¸‚åŠå¹³å¤ªæ—§å®…", level: "â˜…3", pos: [33.5786, 133.5855], q: "åœŸä½å‹¤ç‹å…šã®ãƒªãƒ¼ãƒ€ãƒ¼ã€æ­¦å¸‚åŠå¹³å¤ªã®å¦»ã®åå‰ã¯ï¼Ÿ", ops: ["å¯Œå­", "ãŠé¾", "é¶´"], ans: "å¯Œå­" },
            { name: "å²©å´å¼¥å¤ªéƒç”Ÿå®¶", level: "â˜…2", pos: [33.5215, 133.9212], q: "ä¸‰è±è²¡é–¥ã®å‰µå§‹è€…ãƒ»å¼¥å¤ªéƒã€‚åº­ã«ã€Œæ—¥æœ¬åˆ—å³¶ã€ã‚’æ¨¡ã—ãŸçŸ³ã‚’ä¸¦ã¹ãŸã®ã¯æœ¬å½“ï¼Ÿ", ops: ["æœ¬å½“", "å˜˜"], ans: "æœ¬å½“" },
            { name: "ã‚¸ãƒ§ãƒ³ä¸‡æ¬¡éƒåƒ", level: "â˜…2", pos: [32.7245, 133.0195], q: "ä¸‡æ¬¡éƒãŒã‚¢ãƒ¡ãƒªã‚«ã‹ã‚‰æŒã¡å¸°ã£ãŸã€ABCã®æ­Œä»¥å¤–ã®æœ‰åãªã‚‚ã®ã¯ï¼Ÿ", ops: ["ãƒŸã‚·ãƒ³", "é‰„é“", "ã‚«ãƒ¡ãƒ©"], ans: "ãƒŸã‚·ãƒ³" },
            { name: "å²¡è±ŠåŸï¼ˆé•·å®—æˆ‘éƒ¨å…ƒè¦ªï¼‰", level: "â˜…3", pos: [33.5930, 133.6062], q: "é•·å®—æˆ‘éƒ¨å…ƒè¦ªãŒå››å›½ã‚’çµ±ä¸€ã—ãŸéš›ã€æ‹ ç‚¹ã¨ã—ãŸåŸã¯ï¼Ÿ", ops: ["å²¡è±ŠåŸ", "é«˜çŸ¥åŸ", "æœå€‰åŸ"], ans: "å²¡è±ŠåŸ" },
            { name: "æ¿å£é€€åŠ©åƒ", level: "â˜…1", pos: [33.5601, 133.5312], q: "ã€Œæ¿å£æ­»ã™ã¨ã‚‚è‡ªç”±ã¯æ­»ã›ãšã€ã§æœ‰åãªæ¿å£ã€‚100å††æœ­ã®è‚–åƒã ã£ãŸï¼Ÿ", ops: ["æœ¬å½“", "å˜˜"], ans: "æœ¬å½“" },
            { name: "é›ªè¹Šå¯º", level: "â˜…3", pos: [33.5028, 133.5505], q: "é•·å®—æˆ‘éƒ¨ä¿¡è¦ªã®è©æå¯ºã€‚ã“ã“ã®é–€å‰ã§æœ‰åãªé£Ÿã¹ç‰©ã¯ï¼Ÿ", ops: ["é•·å®—æˆ‘éƒ¨ã¾ã‚“ã˜ã‚…ã†", "ãã°", "ã‚ã‚‰ã³é¤…"], ans: "é•·å®—æˆ‘éƒ¨ã¾ã‚“ã˜ã‚…ã†" },
            { name: "æ—§å±±å†…å®¶ä¸‹å±‹æ•·", level: "â˜…2", pos: [33.5562, 133.5321], q: "å¹•æœ«ã®è—©ä¸»ãƒ»å±±å†…å®¹å ‚ã€‚å½¼ã¯è‡ªåˆ†ã‚’ã€Œé¯¨æµ·é…”ä¾¯ï¼ˆã’ã„ã‹ã„ã™ã„ã“ã†ï¼‰ã€ã¨å‘¼ã‚“ã ï¼Ÿ", ops: ["ã¯ã„", "ã„ã„ãˆ"], ans: "ã¯ã„" },
            
            // --- æ—¢å­˜ãƒ»è¦³å…‰ ---
            { name: "é«˜çŸ¥åŸ", level: "â˜…3", pos: [33.5607, 133.5314], q: "é«˜çŸ¥åŸã®å¤©å®ˆã¨è¿½æ‰‹é–€ãŒä¸¡æ–¹æ®‹ã£ã¦ã„ã‚‹ã®ã¯éå¸¸ã«çã—ã„ï¼Ÿ", ops: ["ã¯ã„", "ã„ã„ãˆ"], ans: "ã¯ã„" },
            { name: "æ¡‚æµœ", level: "â˜…1", pos: [33.4971, 133.5744], q: "æ¡‚æµœã«ã‚ã‚‹å‚æœ¬é¾é¦¬åƒã€‚é¾é¦¬ãŒå³æ‰‹ã‚’æ‡ã«å…¥ã‚Œã¦ã„ã‚‹ã®ã¯ãªãœï¼Ÿ", ops: ["éŠƒã‹ä¸‡å›½å…¬æ³•ã‚’æŒã£ã¦ã„ã‚‹", "å¯’ã„ã‹ã‚‰", "ãƒãƒ¼ã‚º"], ans: "éŠƒã‹ä¸‡å›½å…¬æ³•ã‚’æŒã£ã¦ã„ã‚‹" },
            { name: "å®¤æˆ¸å²¬", level: "â˜…2", pos: [33.2472, 134.1751], q: "å®¤æˆ¸å²¬ã§æœ‰åãªã€å¼˜æ³•å¤§å¸«ãŒæ‚Ÿã‚Šã‚’é–‹ã„ãŸã¨ã•ã‚Œã‚‹æ´çªŸã¯ï¼Ÿ", ops: ["å¾¡å¨äººçªŸ", "é¾æ²³æ´", "é’ã®æ´çªŸ"], ans: "å¾¡å¨äººçªŸ" },
            { name: "é¾æ²³æ´", level: "â˜…3", pos: [33.6033, 133.7436], q: "é¾æ²³æ´ã«ã‚ã‚‹ã€åœŸå™¨ãŒé¾ä¹³çŸ³åŒ–ã—ãŸçã—ã„éºç‰©ã¯ï¼Ÿ", ops: ["ç¥ã®å£º", "æ™‚ã®çš¿", "åœŸå¶"], ans: "ç¥ã®å£º" },
            { name: "å››ä¸‡åå·ãƒ»æ²ˆä¸‹æ©‹", level: "â˜…1", pos: [32.9984, 132.9333], q: "æ²ˆä¸‹æ©‹ã«æ¬„å¹²ï¼ˆæ‰‹ã™ã‚Šï¼‰ãŒãªã„ç†ç”±ã¯ï¼Ÿ", ops: ["å¢—æ°´æ™‚ã«æŠµæŠ—ã‚’æ¸›ã‚‰ã™ãŸã‚", "å®‰ãä½œã‚‹ãŸã‚", "é£›ã³è¾¼ã‚€ãŸã‚"], ans: "å¢—æ°´æ™‚ã«æŠµæŠ—ã‚’æ¸›ã‚‰ã™ãŸã‚" },
            { name: "æŸå³¶", level: "â˜…3", pos: [32.7681, 132.6311], q: "æŸå³¶ã®é€æ˜åº¦ã¯ã€èˆ¹ãŒã€Œã€‡ã€‡ã€ã¦è¦‹ãˆã‚‹ã¨è¨€ã‚ã‚Œã‚‹ï¼Ÿ", ops: ["æµ®ã„ã¦ã‚‹ã‚ˆã†ã«è¦‹ãˆ", "æ²ˆã‚“ã§ã‚‹ã‚ˆã†ã«è¦‹ãˆ", "é€æ˜ã«è¦‹ãˆ"], ans: "æµ®ã„ã¦ã‚‹ã‚ˆã†ã«è¦‹ãˆ" },
            { name: "å®‰å±…æ¸“è°·", level: "â˜…3", pos: [33.6335, 133.1512], q: "ä»æ·€ãƒ–ãƒ«ãƒ¼ã®è±¡å¾´ã€Œæ°´æ™¶æ·µã€ãŒã‚ã‚‹ã®ã¯å®‰å±…æ¸“è°·ã§ã‚ã‚‹ï¼Ÿ", ops: ["æœ¬å½“", "å˜˜"], ans: "æœ¬å½“" }
            // ã‚¹ãƒãƒƒãƒˆã¯ã“ã“ã‹ã‚‰ã•ã‚‰ã«åº§æ¨™ã‚’èª¿ã¹ã¦è¿½åŠ å¯èƒ½ã§ã™
        ];

        questSpots.forEach((spot, index) => {
            const marker = L.marker(spot.pos).addTo(map);

            // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã®è¨­å®šï¼ˆãƒ›ãƒãƒ¼ã§è¡¨ç¤ºï¼‰
            marker.bindTooltip(`<b>${spot.name}</b><br>é›£æ˜“åº¦ï¼š${spot.level}`, {
                direction: 'top',
                offset: [0, -10],
                className: 'custom-tooltip'
            });

            // ã‚¯ãƒªãƒƒã‚¯ã§ã‚¯ã‚¤ã‚ºï¼ˆã‚¹ãƒãƒ›ã§ã¯2å›ç›®ã‚¿ãƒƒãƒ—ï¼‰
            marker.on('click', (e) => {
                L.DomEvent.stopPropagation(e);
                openQuiz(index);
            });
        });

        function openQuiz(index) {
            const spot = questSpots[index];
            document.getElementById('quiz-spot-name').innerText = spot.name;
            document.getElementById('quiz-question').innerText = spot.q;
            const optionsDiv = document.getElementById('quiz-options');
            optionsDiv.innerHTML = ""; 
            spot.ops.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "option-btn";
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(opt, spot.ans);
                optionsDiv.appendChild(btn);
            });
            document.getElementById('quiz-modal').classList.remove('hidden');
        }

        function checkAnswer(userAns, correctAns) {
            if (userAns === correctAns) {
                alert("æ­£è§£ï¼ç§˜å®ã‚²ãƒƒãƒˆãœã‚ˆï¼");
                score++;
                document.getElementById('score').innerText = `ç²å¾—ã—ãŸç§˜å®: ${score} / ${questSpots.length}`;
            } else {
                alert("ãƒã‚ºãƒ¬ï¼æ­´å²ã‚’å­¦ã³ç›´ã—ã¦å‡ºç›´ã—ã¡ã‚„ï¼");
            }
            closeQuiz();
        }

        function closeQuiz() {
            document.getElementById('quiz-modal').classList.add('hidden');
        }
    </script>
</body>
</html>
